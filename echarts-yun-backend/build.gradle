// 清理后端的resources中的前端文件
tasks.register('clean_resources_agent', Delete) {

  delete rootDir.getAbsolutePath() + '/echarts-yun-backend/echarts-yun-main/src/main/resources/agent'
}

// 把插件拷贝到resource中
tasks.register('copy_resources_agent', Copy) {

  mustRunAfter("clean_resources_agent")

  from rootDir.getAbsolutePath() + '/echarts-yun-dist/build/distributions/zhishiyun-agent.tar.gz'
  into rootDir.getAbsolutePath() + '/echarts-yun-backend/echarts-yun-main/src/main/resources/agent'
}

// 后端打包
tasks.register('make', GradleBuild) {

  mustRunAfter(":echarts-yun-dist:build_agent")
  dependsOn("clean_resources_agent", "copy_resources_agent")

  // 构建后端
  tasks = [":echarts-yun-backend:echarts-yun-main:bootJar"]
}